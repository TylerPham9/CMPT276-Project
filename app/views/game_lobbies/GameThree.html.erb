<% provide(:title, 'Game Three ') %>

<p>Game three list test lobbies</p>

<!-- Include the PubNub Library -->
<script src="https://cdn.pubnub.com/pubnub.min.js"></script>
 
<!-- Instantiate PubNub -->
<script type="text/javascript">
 
  var PUBNUB = PUBNUB.init({
    publish_key: 'pub-c-fa71d36a-c3d8-41d0-9171-77d78f073ac8',
    subscribe_key: 'sub-c-2dc695b0-51d7-11e6-9236-02ee2ddab7fe'
  });
  
  var channel = 'Game-Three'
  var $input = $('#chat-input'); // where the user inputs chat text
  var $output = $('#chat-output'); // where output is sent
  
</script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script src="//cdn.pubnub.com/pubnub.min.js"></script>

<div class="panel panel-default">
  <div class="panel-heading">Live Chat</div>
  <ul class="list-group" id="chat-output"></ul>
  <div class="panel-body">
    <form id="chat">
      <div class="input-group">
        <input type="text" class="form-control" id="chat-input" />
        <span class="input-group-btn">
          <button type="submit" class="btn btn-default">Send Message</button>
        </span>
      </div>
    </form>
  </div>
</div>

<script> 
pubnub.subscribe({
  channel: channel, // our channel name
  message: function(text) { // this gets fired when a message comes in

    // create a new line for chat text
    var $line = $('<li />');

    // filter out html from messages
    var $message = $('<span />').text(text).html();

    // build the html elements
    $line.append($message);
    $output.append($line);

    // scroll the chat output to the bottom
    $output.scrollTop($output[0].scrollHeight);

  }
});



// when the "send message" form is submitted
$('#chat').submit(function() {

  // publish input value to channel 
  pubnub.publish({
    channel: channel,
    message: $input.val()
  });

  // clear the input field
  $input.val('');

   // cancel event bubbling
  return false;

});


</script>
